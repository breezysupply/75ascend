---
import Layout from '../layouts/Layout.astro';
import Dashboard from '../components/Dashboard';
import { dataService, initializeApp } from '../utils/amplifyConfig';

// Initialize Amplify
initializeApp();

// This check will happen client-side since Astro runs on the server
// and Auth needs to run in the browser
---

<Layout title="75 ASCEND">
  <Dashboard client:load />
  
  <script>
    // Check authentication on page load
    import { Auth } from 'aws-amplify';
    
    async function checkAuth() {
      try {
        await Auth.currentAuthenticatedUser();
        // User is authenticated, do nothing
      } catch (error) {
        // User is not authenticated, redirect to login
        window.location.href = '/login';
      }
    }
    
    checkAuth();
  </script>
</Layout> 