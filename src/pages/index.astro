---
import Layout from '../layouts/Layout.astro';
import Dashboard from '../components/Dashboard';
import { initializeApp } from '../utils/firebaseConfig';

// Initialize Firebase
initializeApp();

// This check will happen client-side since Astro runs on the server
// and Auth needs to run in the browser
---

<Layout title="75 ASCEND">
  <Dashboard client:load />
  
  <script>
    const isDevelopment = import.meta.env.DEV || process.env.NODE_ENV === 'development';
    
    if (!isDevelopment) {
      const { getAuth, onAuthStateChanged } = await import('firebase/auth');
      
      const auth = getAuth();
      onAuthStateChanged(auth, (user) => {
        if (!user) {
          window.location.href = '/login';
        }
      });
    }
  </script>
</Layout> 